"use strict";(self.webpackChunksecretpad=self.webpackChunksecretpad||[]).push([[693],{4079:function(ce,H,t){t.d(H,{D:function(){return V},I:function(){return A}});var G=t(73193),g=t.n(G),P=t(9580),D=t(58757),S=t(35667),b=P.default.Text,V=function(i){var w=i.children,C=i.width,Z=C===void 0?180:C,F=i.style;return w==null?(0,S.jsx)(P.default.Text,{children:"--"}):(0,S.jsx)(P.default.Text,{ellipsis:{tooltip:w},style:g()({width:Z},F),children:w})},A=function(i){var w=i.suffixCount,C=i.children,Z=C,F="";if(C&&(C==null?void 0:C.length)>w){var $,r;Z=C==null||($=C.slice(0,(C==null?void 0:C.length)-w))===null||$===void 0?void 0:$.trim(),F=C==null||(r=C.slice(-w))===null||r===void 0?void 0:r.trim()}return(0,S.jsx)(b,{style:{width:"100%"},ellipsis:{suffix:F,tooltip:C},children:Z})}},49559:function(ce,H,t){t.d(H,{Fn:function(){return Le},FE:function(){return j},Zk:function(){return U}});var G=t(90819),g=t.n(G),P=t(89933),D=t.n(P),S=t(78796),b=t.n(S),V=t(4977),A=t.n(V),Y=t(41553),i=t.n(Y),w=t(49488),C=t.n(w),Z=t(84047),F=t.n(Z),$=t(10154),r=t.n($),fe=t(45332),R=t.n(fe),ee=t(64881),he=t(37315),J=t(97627),K=t(9580),ne=t(54280),te=t(29116),k=t(80271),ae=t(81675),re=t(92326),ve=t(21058),se=t(37060),me=t(65494),ge=t(17612),y=t(19805),T=t(90634),Q=t(17),X=t(90221),pe=t(81569),Ne={node:"node___GQ3Yz"},n=t(35667),xe=function(l){var p=l.visible,e=l.close,N=l.onOk,x=J.ZP.useMessage(),v=R()(x,2),c=v[0],d=v[1],f=X.Z.useForm(),a=R()(f,1),o=a[0],s=(0,T.tT)(Ce),u=function(){o.validateFields().then(function(){var E=D()(g()().mark(function B(_){var ue,W;return g()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return s.createLoading=!0,M.next=3,(0,y.createNode)({name:_.name,mode:1});case 3:if(ue=M.sent,W=ue.status,!(W&&W.code!==0)){M.next=8;break}return c.error(W.msg),M.abrupt("return");case 8:s.createLoading=!1,c.success("\u300C".concat(_.name,"\u300D\u6CE8\u518C\u6210\u529F\uFF01")),e(),N();case 12:case"end":return M.stop()}},B)}));return function(B){return E.apply(this,arguments)}}())};return(0,n.jsxs)(n.Fragment,{children:[d,(0,n.jsx)(pe.Z,{title:"\u6CE8\u518C\u8282\u70B9",destroyOnClose:!0,open:p,onCancel:e,onOk:u,wrapClassName:Ne.node,children:(0,n.jsx)(X.Z,{form:o,preserve:!1,layout:"vertical",requiredMark:!1,children:(0,n.jsx)(X.Z.Item,{label:"\u8282\u70B9\u540D\u79F0",name:"name",rules:[{max:32,message:"\u957F\u5EA6\u9650\u523632"},{required:!0,message:"\u8BF7\u8F93\u5165\u8282\u70B9\u540D\u79F0"},{pattern:/^[\u4E00-\u9FA5A-Za-z0-9-_]+$/,message:"\u53EA\u80FD\u5305\u542B\u4E2D\u6587/\u82F1\u6587/\u6570\u5B57/\u4E0B\u5212\u7EBF/\u4E2D\u5212\u7EBF"}],children:(0,n.jsx)(re.Z,{placeholder:"\u540D\u79F0\u53EF\u7531\u4E2D\u6587/\u82F1\u6587/\u6570\u5B57/\u4E0B\u5212\u7EBF/\u4E2D\u5212\u7EBF\u7EC4\u6210\uFF0C\u957F\u5EA6\u9650\u523632",allowClear:!0})})})})]})},Ce=function(h){C()(p,h);var l=F()(p);function p(){var e;b()(this,p);for(var N=arguments.length,x=new Array(N),v=0;v<N;v++)x[v]=arguments[v];return e=l.call.apply(l,[this].concat(x)),r()(i()(e),"createLoading",!1),e}return A()(p)}(T.Hn),O={nodeList:"nodeList___bmLLM",nodeListHeader:"nodeListHeader___qXFAy",content:"content___B3I4n",idText:"idText___N0dma",embeddedTag:"embeddedTag___OwEgo"},Ie=t(81495),Ee=t(63486),oe=t(29201),L=t(24554),De=t(62808),de=t(94310),je=t(58757),q=t(4079),I={drawerTitle:"drawerTitle___RI2AV",drawerTitleName:"drawerTitleName___sDT2O",title:"title___ckWHa",left:"left___w7Yq3",badge:"badge___EzSHm",baseTitle:"baseTitle___nMe4J",baseContent:"baseContent___r7rMD",disableText:"disableText___XfacQ",publicKeyPopover:"publicKeyPopover___RMfZo",publicTitle:"publicTitle___JfjiE",publicKey:"publicKey___ogDiN",tokenPopover:"tokenPopover___Ihu4h",contentName:"contentName____ikqT",name:"name___OPlnr",tokenContent:"tokenContent___SPdkW",spanClick:"spanClick___KOm6I",nodeDrawer:"nodeDrawer___f2kGK"},we=K.default.Paragraph,ie=function(h){return h.configured="configured",h.unconfirmed="unconfirmed",h}(ie||{}),ye=function(l){var p=l.visible,e=l.data,N=l.close,x=l.callBack,v=J.ZP.useMessage(),c=R()(v,2),d=c[0],f=c[1],a=(0,T.tT)(Fe),o=a.nodeInfo,s=a.nodeInfoLoading,u=a.refreshStatus,m=a.tokenInfo;je.useEffect(function(){if(p){if(!e)return;a.getNodeInfo(e)}},[e,p]);var E=function(){(0,se.l)({name:o.nodeName||"",description:"",onOk:function(){a.deleteNode(d),N(),x&&x()}})};return(0,n.jsxs)(n.Fragment,{children:[f,(0,n.jsx)(Ee.Z,{closeIcon:!1,className:I.nodeDrawer,title:(0,n.jsxs)("div",{className:I.drawerTitle,children:[(0,n.jsxs)("div",{className:I.drawerTitleName,children:[(0,n.jsxs)("span",{className:I.title,children:[(0,n.jsx)("div",{children:"\u300C"}),(0,n.jsx)("div",{style:{flex:1},children:(0,n.jsx)(q.D,{style:{maxWidth:200,width:"100%"},children:"".concat((o==null?void 0:o.nodeName)||"")})}),(0,n.jsx)("div",{children:"\u300D\u8BE6\u60C5"})]}),(0,n.jsx)(te.Z,{status:U[(o==null?void 0:o.nodeStatus)||j.UNKNOWN].icon,text:U[(o==null?void 0:o.nodeStatus)||j.UNKNOWN].text,className:I.badge})]}),(0,n.jsx)(k.ZP,{type:"link",icon:(0,n.jsx)(ee.Z,{}),onClick:function(){u(d),x&&x()},style:{marginRight:9},children:"\u5237\u65B0"})]}),extra:(0,n.jsx)(Ie.Z,{onClick:function(){return N()},style:{fontSize:12}}),destroyOnClose:!0,open:p,onClose:N,mask:!1,footer:(0,n.jsx)(ae.Z,{style:{float:"right"},children:(o==null?void 0:o.nodeStatus)!==j.READY&&(o==null?void 0:o.type)!=="embedded"&&(0,n.jsx)(k.ZP,{danger:!0,disabled:s,onClick:E,children:"\u5220\u9664"})}),width:560,children:(0,n.jsxs)(oe.Z,{spinning:s,children:[(0,n.jsx)("div",{className:I.baseTitle,children:"\u57FA\u672C\u4FE1\u606F"}),(0,n.jsx)("div",{className:I.baseContent,children:(0,n.jsxs)(L.Z,{column:1,children:[(0,n.jsx)(L.Z.Item,{label:"\u8BA1\u7B97\u8282\u70B9\u540D",children:o.nodeName}),(0,n.jsx)(L.Z.Item,{label:"\u8BA1\u7B97\u8282\u70B9ID",children:(0,n.jsx)(q.D,{children:o.nodeId})}),(0,n.jsx)(L.Z.Item,{label:"\u6CE8\u518C\u65F6\u95F4",children:(0,n.jsx)(q.D,{children:(0,Q.i)(o.gmtCreate||"")})})]})}),(0,n.jsxs)(L.Z,{column:1,children:[(0,n.jsx)(L.Z.Item,{label:"\u90E8\u7F72\u4EE4\u724C",children:(0,n.jsx)(De.Z,{placement:"topLeft",title:"\u90E8\u7F72\u4EE4\u724C",onOpenChange:function(){return a.getToken()},overlayClassName:I.tokenPopover,content:(0,n.jsxs)(oe.Z,{spinning:a.tokenLoading,children:[(0,n.jsxs)("div",{className:I.contentName,children:[(0,n.jsx)(de.Z,{title:m==null?void 0:m.token,children:(0,n.jsx)("span",{className:I.name,children:m==null?void 0:m.token})}),(0,n.jsx)(ne.Z,{color:m.tokenStatus===le.USED?"default":"processing",children:m.tokenStatus===le.USED?"\u5DF2\u4F7F\u7528":"\u672A\u4F7F\u7528"})]}),(0,n.jsxs)("div",{className:I.tokenContent,children:[(0,n.jsx)(we,{copyable:{icon:"\u590D\u5236",text:"".concat(m.token)}}),(0,n.jsx)("div",{className:I.spanClick,onClick:a.getNewToken,children:"\u91CD\u65B0\u751F\u6210"})]})]}),children:(0,n.jsx)("span",{className:I.spanClick,children:"\u67E5\u770B"})})}),(0,n.jsx)(L.Z.Item,{label:"\u8282\u70B9\u8BC1\u4E66",children:o.cert&&o.cert===ie.configured?"\u5DF2\u914D\u7F6E":(0,n.jsx)(de.Z,{title:"\u8282\u70B9\u90E8\u7F72\u6210\u529F\u540E\u5373\u53EF\u914D\u7F6E\u5B8C\u6210",placement:"right",children:(0,n.jsx)("span",{className:I.disableText,children:"\u5F85\u914D\u7F6E"})})})]})]})})]})},Fe=function(h){C()(p,h);var l=F()(p);function p(){var e;b()(this,p);for(var N=arguments.length,x=new Array(N),v=0;v<N;v++)x[v]=arguments[v];return e=l.call.apply(l,[this].concat(x)),r()(i()(e),"nodeInfoLoading",!1),r()(i()(e),"showEditNodeModal",!1),r()(i()(e),"tokenLoading",!0),r()(i()(e),"nodeInfo",{}),r()(i()(e),"tokenInfo",{}),r()(i()(e),"showEditNode",function(){e.showEditNodeModal=!0}),r()(i()(e),"getNodeInfo",function(){var c=D()(g()().mark(function d(f){var a;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return e.nodeInfoLoading=!0,s.next=3,(0,y.get)({nodeId:f});case 3:a=s.sent,a.data&&(e.nodeInfo=a.data),e.nodeInfoLoading=!1;case 6:case"end":return s.stop()}},d)}));return function(d){return c.apply(this,arguments)}}()),r()(i()(e),"refreshNodeInfo",D()(g()().mark(function c(){return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(e.nodeInfo.nodeId){f.next=2;break}return f.abrupt("return");case 2:e.getNodeInfo(e.nodeInfo.nodeId);case 3:case"end":return f.stop()}},c)}))),r()(i()(e),"deleteNode",function(){var c=D()(g()().mark(function d(f){var a,o,s;return g()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(e.nodeInfo.nodeId){m.next=2;break}return m.abrupt("return");case 2:return e.nodeInfoLoading=!0,m.next=5,(0,y.deleteNode)({nodeId:e.nodeInfo.nodeId});case 5:if(o=m.sent,s=o.status,!(s&&s.code!==0)){m.next=10;break}return f.error(s.msg),m.abrupt("return");case 10:f.success("\u300C".concat((a=e.nodeInfo)===null||a===void 0?void 0:a.nodeName,"\u300D\u5220\u9664\u6210\u529F\uFF01")),e.nodeInfoLoading=!1;case 12:case"end":return m.stop()}},d)}));return function(d){return c.apply(this,arguments)}}()),r()(i()(e),"refreshStatus",function(){var c=D()(g()().mark(function d(f){var a;return g()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(e.nodeInfo.nodeId){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,(0,y.refresh)({nodeId:e.nodeInfo.nodeId});case 4:f.success("\u300C".concat((a=e.nodeInfo)===null||a===void 0?void 0:a.nodeName,"\u300D\u5237\u65B0\u6210\u529F\uFF01")),e.refreshNodeInfo();case 6:case"end":return s.stop()}},d)}));return function(d){return c.apply(this,arguments)}}()),r()(i()(e),"getToken",D()(g()().mark(function c(){var d;return g()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e.nodeInfo.nodeId){a.next=2;break}return a.abrupt("return");case 2:return e.tokenLoading=!0,a.next=5,(0,y.token)({nodeId:e.nodeInfo.nodeId});case 5:d=a.sent,e.tokenLoading=!1,e.tokenInfo=(d==null?void 0:d.data)||{};case 8:case"end":return a.stop()}},c)}))),r()(i()(e),"getNewToken",D()(g()().mark(function c(){var d;return g()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(e.nodeInfo.nodeId){a.next=2;break}return a.abrupt("return");case 2:return e.tokenLoading=!0,a.next=5,(0,y.newToken)({nodeId:e.nodeInfo.nodeId});case 5:d=a.sent,e.tokenLoading=!1,e.tokenInfo=(d==null?void 0:d.data)||{};case 8:case"end":return a.stop()}},c)}))),r()(i()(e),"editNode",D()(g()().mark(function c(){return g()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:e.showEditNodeModal=!1;case 1:case"end":return f.stop()}},c)}))),e}return A()(p)}(T.Hn),le=function(h){return h.USED="used",h.UNUSED="unused",h}({}),z=function(h){return h.SUCCEEDED="Succeeded",h.FAILED="Failed",h.PENDING="Pending",h.UNKNOWN="Unknown",h}({}),Ze=r()(r()(r()(r()({},z.SUCCEEDED,{icon:"success",text:"\u53EF\u7528"}),z.FAILED,{icon:"error",text:"\u4E0D\u53EF\u7528"}),z.PENDING,{icon:"default",text:"\u521B\u5EFA\u4E2D"}),z.UNKNOWN,{icon:"error",text:"\u672A\u77E5\u72B6\u6001"}),Te=t(97288),ke=t(62664),Le=function(){var l=(0,T.tT)(Me),p=J.ZP.useMessage(),e=R()(p,2),N=e[0],x=e[1],v=l.showCreateNode,c=(0,ke.TH)(),d=c.pathname,f=[{title:"\u8282\u70B9\u540D\u79F0",dataIndex:"nodeName",key:"nodeName",width:"35%",render:function(s,u){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(K.default.Text,{onClick:function(){return l.showDrawer(u.nodeId)},style:{color:"#1677ff",cursor:"pointer"},ellipsis:{tooltip:s},children:[u.type==="embedded"&&(0,n.jsx)(ne.Z,{className:O.embeddedTag,children:"\u5185\u7F6E"}),s]}),(0,n.jsx)("div",{children:(0,n.jsx)(K.default.Text,{className:O.idText,ellipsis:{tooltip:u.nodeId},children:u.nodeId})})]})}},{title:"\u8282\u70B9\u72B6\u6001",dataIndex:"nodeStatus",key:"nodeStatus",width:"25%",render:function(s,u){return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(te.Z,{status:U[s||j.UNKNOWN].icon,text:U[s||j.UNKNOWN].text}),(0,n.jsx)(k.ZP,{style:{padding:"4px 12px"},type:"link",icon:(0,n.jsx)(ee.Z,{}),onClick:function(){l.refreshNodeStatus(N,u.nodeId,u.nodeName)},children:"\u5237\u65B0"})]})}},{title:"\u6CE8\u518C\u65F6\u95F4",dataIndex:"gmtCreate",width:"25%",sorter:!0,ellipsis:!0,render:function(s){return(0,n.jsx)(K.default.Text,{ellipsis:{tooltip:"".concat((0,Q.i)(s))},children:(0,Q.i)(s)})}},{title:"\u64CD\u4F5C",key:"action",width:"10%",render:function(s,u){return(0,n.jsxs)("div",{className:O.action,children:[u.type==="embedded"&&(0,n.jsx)(k.ZP,{type:"link",style:{padding:0},onClick:function(){var E="nodeId=".concat(u.nodeId);(0,Te.R)(d,"/node",E)},children:"\u8FDB\u5165\u8282\u70B9"}),u.type!=="embedded"&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(k.ZP,{type:"link",disabled:!1,style:{padding:0},onClick:function(){return a(u)},children:"\u5220\u9664"})})]})}}],a=function(s){(0,se.l)({name:s.nodeName||"",description:"",onOk:function(){l.deleteNode(s.nodeName||"",s.nodeId||"",N)}})};return(0,n.jsxs)("div",{className:O.nodeList,children:[(0,n.jsxs)("div",{className:O.nodeListHeader,children:[(0,n.jsx)(ae.Z,{size:"middle",children:(0,n.jsx)(re.Z,{placeholder:"\u641C\u7D22\u8282\u70B9\u540D/ID/\u901A\u8BAF\u5730\u5740",onChange:function(s){return l.searchNode(s)},style:{width:200},suffix:(0,n.jsx)(he.Z,{style:{color:"#aaa"}})})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(k.ZP,{type:"primary",onClick:v,children:"\u6CE8\u518C\u65B0\u8282\u70B9"}),(0,n.jsx)(k.ZP,{type:"link",onClick:function(){var s="https://www.secretflow.org.cn/docs/quickstart/fn9h9yqoievouz2a",u=document.createElement("a");u.href=s,u.target="_blank",u.click()},children:"\u64CD\u4F5C\u624B\u518C"})]})]}),(0,n.jsx)("div",{className:O.content,children:(0,n.jsx)(ve.Z,{loading:l.loading,dataSource:l.nodeList,columns:f,onChange:function(s,u,m){return l.typeFilter(u,m)},pagination:{total:l.totalNum||1,current:l.pageNumber,pageSize:l.pageSize,onChange:function(s,u){l.pageNumber=s,l.pageSize=u},size:"default",showSizeChanger:!0},size:"small",rowKey:function(s){return s.nodeId}})}),(0,n.jsx)(xe,{visible:l.showCreateNodeModel,close:function(){return l.showCreateNodeModel=!1},onOk:function(){return l.getNodeList()}}),(0,n.jsx)(ye,{visible:l.showDetailDrawer,data:l.drawerId,close:function(){return l.showDetailDrawer=!1},callBack:function(){return l.getNodeList()}}),x]})},Me=function(h){C()(p,h);var l=F()(p);function p(){var e;b()(this,p);for(var N=arguments.length,x=new Array(N),v=0;v<N;v++)x[v]=arguments[v];return e=l.call.apply(l,[this].concat(x)),r()(i()(e),"nodeList",[]),r()(i()(e),"nodeListDisplay",[]),r()(i()(e),"search",""),r()(i()(e),"typesFilter",[]),r()(i()(e),"sortRule",{}),r()(i()(e),"pageNumber",1),r()(i()(e),"pageSize",10),r()(i()(e),"totalNum",1),r()(i()(e),"loading",!1),r()(i()(e),"searchDebounce",void 0),r()(i()(e),"showDetailDrawer",!1),r()(i()(e),"drawerId",""),r()(i()(e),"showCreateNodeModel",!1),r()(i()(e),"showEditNodeModel",!1),r()(i()(e),"nodeService",(0,T.PD)(ge.s)),r()(i()(e),"loginService",(0,T.PD)(me.r)),r()(i()(e),"searchNode",function(c){e.search=c.target.value,clearTimeout(e.searchDebounce),e.searchDebounce=setTimeout(function(){e.getNodeList()},300)}),r()(i()(e),"typeFilter",function(c,d){d!=null&&d.order?e.sortRule=r()({},d.field,d.order==="ascend"?"ASC":"DESC"):e.sortRule={},e.getNodeList()}),r()(i()(e),"showDrawer",function(c){e.drawerId=c,e.showDetailDrawer=!0}),r()(i()(e),"showCreateNode",function(){e.showCreateNodeModel=!0}),r()(i()(e),"showEditNode",function(c){e.drawerId=c,e.showEditNodeModel=!0}),r()(i()(e),"deleteNode",function(){var c=D()(g()().mark(function d(f,a,o){var s,u;return g()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,(0,y.deleteNode)({nodeId:a});case 2:if(s=E.sent,u=s.status,!(u&&u.code!==0)){E.next=7;break}return o.error(u.msg),E.abrupt("return");case 7:o.success("\u300C".concat(f,"\u300D\u5220\u9664\u6210\u529F\uFF01")),e.getNodeList();case 9:case"end":return E.stop()}},d)}));return function(d,f,a){return c.apply(this,arguments)}}()),r()(i()(e),"refreshNodeStatus",function(){var c=D()(g()().mark(function d(f,a,o){return g()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(!a||!o)){u.next=2;break}return u.abrupt("return");case 2:return e.showDetailDrawer=!1,u.next=5,(0,y.refresh)({nodeId:a});case 5:f.success("\u300C".concat(o,"\u300D\u5237\u65B0\u6210\u529F\uFF01")),e.getNodeList();case 7:case"end":return u.stop()}},d)}));return function(d,f,a){return c.apply(this,arguments)}}()),e}return A()(p,[{key:"onViewMount",value:function(){var N,x,v=((N=this.loginService.userInfo)===null||N===void 0?void 0:N.platformType)==="CENTER"&&((x=this.loginService.userInfo)===null||x===void 0?void 0:x.ownerType)==="EDGE";v||this.getNodeList()}},{key:"onViewUnMount",value:function(){this.search=""}},{key:"getNodeList",value:function(){var e=D()(g()().mark(function x(){var v,c,d;return g()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this.loading=!0,a.next=3,(0,y.page)({page:this.pageNumber,size:this.pageSize,search:this.search,sort:this.sortRule});case 3:d=a.sent,this.loading=!1,this.totalNum=(d==null||(v=d.data)===null||v===void 0?void 0:v.total)||0,this.nodeList=(d==null||(c=d.data)===null||c===void 0?void 0:c.list)||[],this.nodeListDisplay=this.nodeList;case 8:case"end":return a.stop()}},x,this)}));function N(){return e.apply(this,arguments)}return N}()}]),p}(T.Hn),j=function(h){return h.READY="Ready",h.NOTREADY="NotReady",h.PENDING="Pending",h.UNKNOWN="Unknown",h.SUCCEEDED="Succeeded",h.FAILED="Failed",h}({}),U=r()(r()(r()(r()(r()(r()({},j.READY,{icon:"success",text:"\u53EF\u7528"}),j.NOTREADY,{icon:"error",text:"\u4E0D\u53EF\u7528"}),j.PENDING,{icon:"default",text:"\u521B\u5EFA\u4E2D"}),j.UNKNOWN,{icon:"error",text:"\u4E0D\u53EF\u7528"}),j.SUCCEEDED,{icon:"success",text:"\u53EF\u7528"}),j.FAILED,{icon:"error",text:"\u4E0D\u53EF\u7528"})}}]);
